package days04;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.Map.Entry;
import java.util.Set;

import com.util.DBConn;

import domain.DeptEmpVO;
import domain.DeptVO;
import domain.EmpVO2;

public class Ex01_02 {

	public static void main(String[] args) {
		/*
		[실행결과]
ACCOUNTING(10)-3명
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
RESEARCH(20)-3명
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
SALES(30)-6명
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
  empno ename hiredate pay
OPERATIONS(40)-1명
  empno ename hiredate pay 
NULL - 1명
  empno ename hiredate pay
       */
       

		
		String deptSql = "SELECT dname,d.deptno,COUNT(*)  "
				+ "FROM dept d RIGHT OUTER JOIN emp e ON e.deptno = d.deptno  "
				+ "GROUP BY dname,d.deptno "
				+ "ORDER BY d.deptno ASC ";
		
		String empSql = "SELECT empno,ename,hiredate,sal+NVL(comm,0) pay "
				+ "FROM emp "
				+ "WHERE deptno = ? ";
		
		
		
		
		PreparedStatement pstmt =null , deptPstmt= null;;
		Connection conn = null;
		ResultSet rs= null, deptRs= null;;
		DeptVO dvo = null;
		
		conn = DBConn.getConnection();
		
//		ArrayList<EmpVO2> aevo = null;
//		LinkedHashMap<DeptEmpVO, ArrayList<EmpVO2>> map = null;
//		EmpVO2 evo = null; 
		
		conn = DBConn.getConnection();
		try {
			deptPstmt = conn.prepareStatement(deptSql);
			deptRs = deptPstmt.executeQuery();
			
			if (deptRs.next()) {
				
				do {
					dvo = DeptVO.builder()
							.deptno(deptRs.getInt("deptno"))
							.dname(deptRs.getString("dname"))
							.build();
					System.out.printf("%s(%d)-00명\n"
							,dvo.getDname()
							,dvo.getDeptno());
					
					
					
				} while (deptRs.next());
				
			}
			
			
		} catch (SQLException e) {
			
			e.printStackTrace();
		}catch (Exception e) {
			
			e.printStackTrace();
		}finally {
			try {
				deptRs.close();
				deptPstmt.close();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
		
		
		
		DBConn.close();
	}//main

}//class


















